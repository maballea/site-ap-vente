{% extends 'base.html.twig' %}

{% block title %}Hello UserController!{% endblock %}

{% block body %}
<!-- Contenu principal avec Bootstrap -->
<div class="container py-5">
    <h1 class="text-center mb-4">Bienvenue !</h1>

    <!-- Bouton catalogue -->
    <div class="d-flex justify-content-center">
        <button class="btn btn-primary" onclick="window.location.href='{{ path('produit_catalogue') }}'">Catalogue</button>
    </div>

    {% if app.user %}
        <!-- Bouton de déconnexion -->
        <div class="d-flex justify-content-center mt-3">
            <button class="btn btn-danger" id="deconnexion-btn">Déconnexion</button>
        </div>

        <script>
            document.querySelector('#deconnexion-btn').addEventListener('click', function(event) {
                if (!confirm('Êtes-vous sûr de vouloir vous déconnecter ? Votre panier sera perdu.')) {
                    event.preventDefault();
                } else {
                    window.location.href = '{{ path('app_logout') }}';
                }
            });
        </script>

    {% else %}
        <!-- Boutons d'inscription et de connexion -->
        <div class="d-flex justify-content-center mt-3">
            <button class="btn btn-success mx-2" onclick="window.location.href='{{ path('app_register') }}'">S'inscrire</button>
            <button class="btn btn-info mx-2" onclick="window.location.href='{{ path('app_login') }}'">Se connecter</button>
        </div>
    {% endif %}
</div>

<!-- Section Produits en Vogue -->
<div class="container mt-5">
    <h2 class="text-center mb-4">Produits en Vogue</h2>
    <div class="row">
        {% for produitData in produitsEnVogue %}
            {% set produit = produitData[0] %}
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm border-light rounded">
                    <!-- Image redimensionnée à 32x32 px -->
                    <img class="card-img-top" src="{{ produit.image }}" alt="{{ produit.nom }}" style="width: 32px; height: 32px; object-fit: cover; margin: 0 auto;">
                    <div class="card-body">
                        <h5 class="card-title">{{ produit.nom }}</h5>
                        <p class="card-text">Vendu {{ produitData.totalVentes }} fois</p>
                        <a href="{{ path('produit_catalogue') }}" class="btn btn-primary w-100">Voir le produit</a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

{% endblock %}
